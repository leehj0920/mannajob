<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mannajob.mapper.MainMapper">
	<!-- 현직자 프로필 검색 -->
	<resultMap type="com.mannajob.domain.MemberVO" id="memVO">
		<result property="m_name" column="m_name"/>
	</resultMap>
	<resultMap type="com.mannajob.domain.FileVO" id="fileVO">
		<result property="stored_file_name" column="stored_file_name"/>
	</resultMap>
	<resultMap type="com.mannajob.domain.EmplVO" id="emplVO">
		<id property="e_num" column="e_num"/>
		<result property="m_id" column="m_id"/>
		<result property="e_corp" column="e_corp"/>
		<result property="e_career" column="e_career" />
		<result property="e_task" column="e_task"/>
		<association property="memVO" resultMap="memVO"></association>
		<association property="fileVO" resultMap="fileVO"></association>
	</resultMap>
	
	<!-- 현직자 매칭글 검색 -->
	<resultMap type="com.mannajob.domain.BMatchVO" id="bmatchVO">
		<result property="b_num" column="b_num"/>
		<result property="b_subject" column="b_subject"/>
		<result property="b_stdate" column="b_stdate"/>
		<result property="b_endate" column="b_endate"/>
		<result property="b_price" column="b_price"/>
		<result property="b_task" column="b_task"/>
		<result property="b_corp" column="b_corp"/>
		<result property="b_location" column="b_location"/>
	</resultMap>
	
	<select id="searchEmplMat" resultMap="bmatchVO">
		SELECT b_num, b_subject, b_stdate, b_endate, b_price, b_task, b_corp, b_location
		FROM b_match
		WHERE b_category = 'A' AND b_subject = '%'||#{b_subject}||'%' AND b_task = '%'||#{b_task}||'%' AND b_corp = '%'||#{b_corp}||'%' AND b_location = '%'||#{b_location}||'%' 
	</select>
	
	<!-- 현직자 검색 -->
	<select id="searchEmpl" resultMap="emplVO">
		SELECT f.stored_file_name 사진, m.m_name 이름, e.e_corp 직장, e.e_career 경력, e.e_task 직무
		FROM m_file f, member m, empl e
		WHERE f.e_num = e.e_num AND m.m_id = e.m_id
	</select>
</mapper>
