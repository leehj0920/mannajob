<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mannajob.mapper.MatchMapper">
	<resultMap type="com.mannajob.domain.MatchVO" id="Match">
		<result property="mat_num" column="mat_num"/>
		<result property="b_num" column="b_num"/>
		<result property="m_id" column="m_id"/>
		<result property="mat_hour" column="mat_hour"/>
		<result property="mat_stdate" column="mat_stdate"/>
		<result property="mat_wdate" column="mat_wdate"/>
		<result property="mat_okdate" column="mat_okdate"/>
		<result property="mat_state" column="mat_state"/>
	</resultMap>
	
	<resultMap type="com.mannajob.domain.ReviewVO" id="Review">
		<result property="r_contents" column="r_contents"/>
	</resultMap>
	
	<resultMap type="com.mannajob.domain.BMatchVO" id="BMatch">
		<result property="b_num" column="b_num"/>
		<result property="b_category" column="b_category"/>
		<result property="m_id" column="m_id"/>
		<result property="b_corp" column="b_corp"/>
		<result property="b_task" column="b_task"/>
		<result property="b_price" column="b_price"/>
		<result property="b_location" column="b_location"/>
		<result property="b_stdate" column="b_stdate"/>
		<result property="b_endate" column="b_endate"/>
		<result property="b_period" column="b_period"/>
		<result property="b_del" column="b_del"/>
		<result property="b_state" column="b_state"/>
		<result property="b_subject" column="b_subject"/>
		<result property="b_wdate" column="b_wdate"/>
		<result property="b_contents" column="b_contents"/>
		<collection property="matchVO" resultMap="Match"/>
		<collection property="reviewVO" resultMap="Review"/>
	</resultMap>

	<!-- 매칭 작성 내역 조회 -->
	<select id="searchBMat" resultType="com.mannajob.domain.BMatchVO">
		SELECT b_num, b_subject, b_state FROM b_match WHERE m_id = #{m_id}
	</select>
	
	<!-- 매칭 신청 현황 -->
	<select id="searchBmatMat" resultType="com.mannajob.domain.MatchVO">
		SELECT mat_num, mat_stdate, mat_hour, m_id FROM match WHERE b_num = #{b_num}
	</select>
	
		<!-- 매칭 신청 내역 조회-->
	<select id="searchMat" resultMap="BMatch">
		SELECT m.mat_num, b.b_subject, m.mat_state, b.m_id, m.m_id, r.r_contents FROM b_match b, match m LEFT JOIN review r ON m.mat_num = r.mat_num WHERE b.b_num = m.b_num AND m.m_id = #{m_id} ORDER BY m.mat_num DESC 
	</select>
	

</mapper>